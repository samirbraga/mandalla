function loadAgInfo(){var e=document.querySelectorAll(".audio-enclosure");e&&e.length>0&&function(){$(e).each(function(e){function a(e){return minutes=Math.floor(e/60),minutes=minutes>=10?minutes:"0"+minutes,e=Math.floor(e%60),e=e>=10?e:"0"+e,minutes+":"+e}var n=e.getAttribute("data-id"),t=e.querySelector("audio"),i=e.querySelector(".range-line"),o=e.querySelector(".time-line-container"),r=e.querySelector(".range-line .progress"),s=e.querySelector(".range-line .buffer"),c=e.querySelector(".left-controls"),u=e.querySelector(".time"),l=e.parentNode.parentNode.querySelector(".load-overlay"),d=!1;$(t).on("ended",function(){$(c).html('<i class="fa fa-play fa-lg" ></i>')}),$(t).on("pause",function(){$(c).html('<i class="fa fa-play fa-lg" ></i>'),d=!0}),$(t).on("play",function(){$(c).html('<i class="fa fa-pause fa-lg" ></i>'),d||postData("",{id:"id"},function(e,a){(e||"error"==a)&&alert("Houve um problema.\n\nTente mais tarde.")},"POST","/admin/inc-audio-listen-count/"+n)}),$(t).on("progress",function(){if(t.buffered.length>0){var e=100*t.buffered.end(0)/t.duration;$(s).css("width",e+"%")}}),$(t).on("canplay",function(){$(l).class.add("hidden")}),$(t).on("waiting",function(){$(l).class.remove("hidden")}),$(t).on("canplaythrough",function(){$(l).class.add("hidden")}),$(window).on("resize",function(){$(r).css("width",h.rngWidthByTime()+"px")});var f=function(){var e=a(t.currentTime),n=a(t.duration);$(u).html(e+" | "+n)};$(t).on("canplay",function(){f()}),$(t).on("timeupdate",function(){if($(r).css("width",h.rngWidthByTime()+"px"),f(),t.buffered.length>0){var e=100*t.buffered.end(0)/t.duration;$(s).css("width",e+"%")}});var h={rngWidthByTime:function(){var e=t.duration;return t.currentTime*$(i).width()/e},timeByXPos:function(e){var a=e,n=$(i).offset().left,o=$(i).width(),r=a-n>=o?o:a-n,s=t.duration;t.currentTime;return s*r/o}};$(c).on("click",function(){t.paused?t.play():t.pause()});var p=!1,m=function(e){p=!0,t.volume=0,t.currentTime=h.timeByXPos(e.pageX||e.changedTouches[0].pageX)},g=function(e){e.preventDefault(),p&&(t.currentTime=h.timeByXPos(e.pageX||e.changedTouches[0].pageX))};$(e).on("selectstart",function(e){return e=e||widnow.event,e.preventDefault(),!1}),$(o).on("mousedown",m),$(o).on("touchstart",m),$(window).on("mousemove",g),$(o).on("touchmove",g),$(window).on("mouseup",function(e){p=!1,t.volume=1})})}()}loadAgInfo();var agSearchform=document.querySelector(".audiographs-search-container form"),searchInput=agSearchform.querySelector("input"),ag_list=document.querySelector(".audiographs-list-container"),searchResult,doSearch=function(e){e&&e.preventDefault();var a=searchResult,n=searchInput.value.trim().parseToSearch().parseToRegex();if(searchResult=dataAudiographs.filter(function(e,a){if(new RegExp(n,"gi").test(e.street_name.parseToSearch()))return!0}),JSON.stringify(a)!=JSON.stringify(searchResult)){ag_list.style.opacity=0,setTimeout(function(){ag_list.innerHTML=jsonToHTML(searchResult,'<div class="audiograph-container"><div class="load-overlay hidden" ><i class="fa fa-circle-o-notch fa-spin fa-2x fa-fw"></i></div><figure class="audiograph-picture" ><img src="{{instagram_image_url}}" alt=""></figure><div class="audiograph-content"><div class="audiograph-title" ><span><i class="fa fa-instagram" ></i> <a target="_blank" href="{{instagram_link}}">{{street_name}}</a></span></div><div class="audiograph-counts" data-id="{{_id}}" ><span class="listen-count" ><i class="fa fa-headphones" ></i> <span>{{listen_count}}</span></span></div><div class="audio-enclosure"  data-id="{{_id}}"><audio><source src="http://localhost:7000/ag/{{audio_file}}" type="audio/mp3"></audio><div class="controls-container"><div class="left-controls"><i class="fa fa-play fa-lg" ></i></div><div class="time-line-container"><div class="range-line"><div class="progress"></div><div class="buffer"></div></div></div><div class="time"><span></span></div></div></div></div></div></div>',"<div class='ag-not-found' ><i class='fa fa-exclamation-circle' ></i> <span>Nenhuma audiografia encontrada.</span></div>"),setTimeout(function(){ag_list.style.opacity=1},10),loadAgInfo()},100)}return!1};if(agSearchform.addEventListener("submit",doSearch),searchInput.addEventListener("input",doSearch),autoSearch){var rootElements=document.querySelectorAll("body, html");$(rootElements).scrollY(window.innerHeight),searchInput.value=autoSearch,doSearch()}