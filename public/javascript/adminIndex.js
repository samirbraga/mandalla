function updateData(){dataRequest("establishments",function(e,t){e?alert("Algo errado aconteceu :( \n \nTente novamente mais tarde."):(establishmentsData=t,renderListRemove(establishmentsData),renderListUpdate(establishmentsData))})}function updateAudioData(){dataRequest("audiographs",function(e,t){e?alert("Algo errado aconteceu :( \n \nTente novamente mais tarde."):(audiographsData=t,renderAudiosRemove(audiographsData))})}function addEstablishment(){if(confirm("Adicionar estabelecimento? \n\nTenha certeza que já revisou todas as informações fornecidas.")){var e=document.querySelector(".tabs-container .tab.add form"),t=e.querySelectorAll("input[type=text], textarea"),a={};$(t).each(function(e,t){a[e.name]=e.value}),postData("/admin/add-establishment",a,function(e,a){e||"error"==a?alert("Não foi possível completar a ação, tente novamente mais tarde."):(updateData(),$(t).value(""))})}}function renderListRemove(e){var t=document.querySelector(".tab.remove .establishments-list"),a=e.map(function(e,t){return'<li class="clearfix" ><div class="list-header"><span>'+e.name+'</span><button data-id="'+e._id+'" class="remove-establishments"><i class="fa fa-trash"></i> Remover</button></div><div class="list-content" ><hr><p><b>Nome</b>: '+e.name+"</p><p><b>Site</b>: "+e.site+"</p><p><b>Ramo</b>: "+e.trading+"</p><p><b>Endereço</b>: "+e.street+", "+e.number+" - "+e.district+"</p><p><b>Lat e Lng</b>: "+e.latLng.join(", ")+"</p><br></div></li>"}).join(""),n=document.createElement("ul");n.innerHTML=a;var r=document.createDocumentFragment();r.appendChild(n),t.innerHTML="",t.appendChild(r);var i=document.querySelectorAll(".tab.remove .establishments-list li .list-header");$(i).on("click",function(){var e=this,t=e.parentNode;$(i).each(function(t){t!=e&&$(t.parentNode).class.remove("selected")}),$(t).class.toggle("selected")});var s=document.querySelectorAll(".tab.remove .remove-establishments");$(s).on("click",function(){if(confirm("Tem certeza que deseja remover esse estabelecimento?\n\nEssa ação é irreversível!")){var e=this.getAttribute("data-id");postData("/admin/remove-establishment/"+e,{id:"id"},function(e,t){e||"error"==t?alert("Não foi possível remover.\n\nTente novamente mais tarde."):updateData()},"DELETE")}})}function renderListUpdate(e){var t=document.querySelector(".tab.update .establishments-list"),a=e.map(function(e,t){return'<li class="clearfix" ><div class="list-header"><span>'+e.name+'</span><button data-id="'+e._id+'" class="update-establishments"><i class="fa fa-refresh"></i> Atualizar</button></div><div class="list-content" ><hr><p><b>Nome</b>: '+e.name+"</p><p><b>Site</b>: "+e.site+"</p><p><b>Ramo</b>: "+e.trading+"</p><p><b>Endereço</b>: "+e.street+", "+e.number+" - "+e.district+"</p><p><b>Lat e Lng</b>: "+e.latLng.join(", ")+"</p><br></div></li>"}).join(""),n=document.createElement("ul");n.innerHTML=a;var r=document.createDocumentFragment();r.appendChild(n),t.innerHTML="",t.appendChild(r);var i=document.querySelectorAll(".tab.update .establishments-list li .list-header");$(i).on("click",function(){var e=this,t=e.parentNode;$(i).each(function(t){t!=e&&$(t.parentNode).class.remove("selected")}),$(t).class.toggle("selected")});var s=document.querySelectorAll(".update-establishments");$(s).on("click",function(){if(confirm("Tem certeza que deseja remover esse estabelecimento?\n\nEssa ação é irreversível!")){var e=this.getAttribute("data-id");postData("/admin/remove-establishment/"+e,{id:"id"},function(e,t){e||"error"==t?alert("Não foi possível remover.\n\nTente novamente mais tarde."):updateData()},"DELETE")}})}function renderAudiosRemove(e){var t=document.querySelector(".tab.remove .audios-list"),a=e.map(function(e,t){return'<li class="clearfix" ><div class="list-header"><span>'+e.street_name+'</span><button data-id="'+e._id+'" class="remove-audio"><i class="fa fa-trash"></i> Remover</button></div><div class="list-content" ><hr><p><b>Nome da respectiva rua</b>: '+e.street_name+"</p><p><b>Link do instagram</b>: "+e.instagram_link+"</p><p><b>Visualizações</b>: "+e.listen_count+'</p><p><b>Áudio</b>: <audio controls style="vertical-align: middle;" ><source src="/ag/'+e.audio_file+'" type="audio/mp3" ></audio></p></div></li>'}).join(""),n=document.createElement("ul");n.innerHTML=a;var r=document.createDocumentFragment();r.appendChild(n),t.innerHTML="",t.appendChild(r);var i=document.querySelectorAll(".tab.remove .audios-list li .list-header");$(i).on("click",function(){var e=this,t=e.parentNode;$(i).each(function(t){t!=e&&$(t.parentNode).class.remove("selected")}),$(t).class.toggle("selected")});var s=document.querySelectorAll(".tab.remove .remove-audio");$(s).on("click",function(){if(confirm("Tem certeza que deseja remover essa audiografia?\n\nEssa ação é irreversível!")){var e=this.getAttribute("data-id");postData("/admin/remove-audio/"+e,{id:"id"},function(e,t){e||"error"==t?alert("Não foi possível remover.\n\nTente novamente mais tarde."):updateAudioData()},"DELETE")}})}var establishmentsData,audiographsData;updateData(),updateAudioData();var searchRemoveInput=document.querySelector(".tab.remove .search-name");$(searchRemoveInput).on("input",function(){var e=this.value.parseToRegex(),t=new RegExp(e,"gi");renderListRemove(establishmentsData.filter(function(e,a){return t.test(e.name)}))});var searchUpdateInput=document.querySelector(".tab.update .search-name");$(searchUpdateInput).on("input",function(){var e=this.value.trim().parseToRegex(),t=new RegExp(e,"gi");renderListUpdate(establishmentsData.filter(function(e,a){return t.test(e.name)}))});var searchRemoveAudio=document.querySelector(".audios-manage .tab.remove .search-name");$(searchRemoveAudio).on("input",function(){var e=this.value.trim().parseToRegex(),t=new RegExp(e,"gi"),a=audiographsData.filter(function(e,a){return t.test(e.street_name)});console.log(a),renderAudiosRemove(a)});var tabsTitle=document.querySelectorAll(".tab-title"),tabs;$(tabsTitle).on("click",function(){var e=this.getAttribute("data-target"),t=document.getElementById(e);tabs=t.parentNode.children,$(tabs).class.remove("activated"),$(t).class.add("activated"),$(this.parentNode.children).class.remove("activated"),$(this).class.add("activated")});